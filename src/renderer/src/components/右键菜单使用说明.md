# SearchCategories 右键菜单使用说明

## 功能概述

为 SearchCategories 组件添加了全局通用的右键菜单功能，支持删除和固定应用。

## 新增功能

### 1. 右键菜单配置

在 `SearchCategory` 接口中新增了 `contextMenu` 配置选项：

```typescript
interface SearchCategory {
  id: string;
  name: string;
  items: AppItem[];
  isDragEnabled: boolean;
  maxDisplayCount: number;
  isExpanded: boolean;
  customSearch?: (searchText: string, items: AppItem[]) => AppItem[];
  // 右键菜单配置
  contextMenu?: {
    enableDelete?: boolean; // 是否启用删除功能，默认 true
    enablePin?: boolean; // 是否启用固定功能，默认 true
  };
}
```

### 2. 新增事件

组件新增了两个事件：

```typescript
interface Emits {
  (e: "app-click", app: AppItem): void;
  (e: "category-toggle", categoryId: string): void;
  (e: "category-drag-end", categoryId: string, items: AppItem[]): void;
  (e: "app-delete", app: AppItem, categoryId: string): void; // 新增
  (e: "app-pin", app: AppItem, categoryId: string): void; // 新增
}
```

## 使用方法

### 1. 基本使用

```vue
<template>
  <SearchCategories
    :categories="searchCategories"
    @app-click="launchApp"
    @category-toggle="handleCategoryToggle"
    @category-drag-end="handleCategoryDragEnd"
    @app-delete="handleAppDelete"
    @app-pin="handleAppPin"
  />
</template>

<script setup>
// 处理应用删除
const handleAppDelete = async (app, categoryId) => {
  // 从分类中移除应用
  // 保存到存储
};

// 处理应用固定
const handleAppPin = async (app, categoryId) => {
  // 从原分类移除
  // 添加到固定分类
  // 保存到存储
};
</script>
```

### 2. 配置右键菜单

```typescript
const searchCategories = ref([
  {
    id: "pinned",
    name: "已固定",
    items: [],
    isDragEnabled: true,
    maxDisplayCount: 20,
    isExpanded: true,
    // 固定分类不支持固定功能
    contextMenu: {
      enableDelete: true,
      enablePin: false, // 已固定的应用不能再固定
    },
  },
  {
    id: "recent",
    name: "最近使用",
    items: [],
    isDragEnabled: true,
    maxDisplayCount: 20,
    isExpanded: true,
    // 最近使用分类支持所有功能
    contextMenu: {
      enableDelete: true,
      enablePin: true,
    },
  },
  {
    id: "files",
    name: "文件",
    items: [],
    isDragEnabled: true,
    maxDisplayCount: 20,
    isExpanded: true,
    // 文件分类可以禁用删除功能
    contextMenu: {
      enableDelete: false, // 禁用删除
      enablePin: true,
    },
  },
]);
```

## 功能特性

### 1. 智能菜单显示

- 根据分类配置动态显示菜单项
- 固定分类中的应用不显示"固定"选项
- 可以完全禁用某个分类的右键菜单功能

### 2. 菜单定位

- 自动防止菜单超出屏幕边界
- 智能调整菜单位置
- 支持键盘 ESC 关闭

### 3. 视觉反馈

- 危险操作（删除）使用红色标识
- 悬停效果和过渡动画
- 图标和快捷键支持
- 使用项目中已有的图标组件（如 IconMdiCog、IconMdiApplication）

### 4. 事件处理

- 完整的删除和固定逻辑
- 自动保存到 electron-store
- 支持跨分类操作
- 固定功能：复制应用到固定分类，不移除原分类中的应用
- 删除功能：从当前分类中移除应用

## 注意事项

1. **固定功能行为**：固定功能会复制应用到固定分类，不会从原分类中删除
2. **删除确认**：当前版本没有删除确认对话框，建议在父组件中添加
3. **存储同步**：所有操作都会自动同步到 electron-store
4. **性能优化**：菜单使用 Teleport 渲染到 body，避免层级问题
5. **图标使用**：菜单项图标需要使用项目中自动导入的图标组件名称字符串，如 `'IconMdiCog'`、`'IconMdiApplication'` 等

## 扩展建议

1. 添加删除确认对话框
2. 支持更多菜单项（如重命名、属性等）
3. 添加键盘快捷键支持
4. 支持自定义菜单项
